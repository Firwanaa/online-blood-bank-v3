{"ast":null,"code":"import { BloodType } from 'src/app/enumerations/bloodType.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../donor.service\";\nimport * as i2 from \"src/app/service/notification.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\n\nfunction DonorListComponent_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 12);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const bloodType_r2 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", bloodType_r2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", bloodType_r2, \" \");\n  }\n}\n\nfunction DonorListComponent_ng_container_66_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"tr\")(2, \"td\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"td\")(13, \"span\", 23);\n    i0.ɵɵtext(14, \"Available\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"span\", 24);\n    i0.ɵɵtext(16, \"Unavailable\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"td\")(18, \"button\", 25);\n    i0.ɵɵlistener(\"click\", function DonorListComponent_ng_container_66_Template_button_click_18_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const donor_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return ctx_r4.SendRequest(donor_r3.username);\n    });\n    i0.ɵɵtext(19, \" Send Request \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelement(20, \"td\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const donor_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(donor_r3.userId);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(donor_r3.username);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(donor_r3.email);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(donor_r3.city);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(donor_r3.bloodType);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"hidden\", !donor_r3[\"available\"]);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"hidden\", donor_r3[\"available\"]);\n  }\n}\n\nexport let DonorListComponent = /*#__PURE__*/(() => {\n  class DonorListComponent {\n    constructor(donorService, notificationService) {\n      this.donorService = donorService;\n      this.notificationService = notificationService;\n      this.donors = [];\n      this.bloodTypes = Object.values(BloodType);\n      this.city = '';\n      this.hospital_icon = {\n        url: 'src/assets/hospital.png',\n        scaledSize: new google.maps.Size(50, 50) // scaled size\n\n      };\n      this.person_icon = {\n        url: 'src/assets/person.png',\n        scaledSize: new google.maps.Size(50, 50) // scaled size\n\n      };\n    }\n\n    ngOnInit() {\n      this.donorService.getDonors().subscribe(donors => {\n        this.donors = donors;\n        console.log(donors);\n        donors.forEach(d => {\n          console.log(d['available']);\n          console.log(d['userID']);\n        });\n        this.notificationService.notify('success', donors.length + ' donors loaded successfully');\n        this.initMap(donors);\n      }, error => console.log(error));\n    }\n\n    SearchCity(city) {\n      this.donorService.findByCity(this.city.toString()).subscribe(donors => {\n        this.donors = donors;\n        this.initMap(donors);\n      }, error => console.log(error));\n    }\n\n    ResetFilter() {\n      this.donorService.getDonors().subscribe(donors => {\n        this.donors = donors;\n        console.log(donors);\n        donors.forEach(d => {\n          console.log(d['available']);\n          console.log(d['lat']);\n        });\n        this.notificationService.notify('success', donors.length + ' donors loaded successfully');\n        this.initMap(donors);\n      }, error => console.log(error));\n    }\n\n    SearchBloodType(bloodType) {\n      this.donorService.findByDonorBloodtype(bloodType).subscribe(donors => {\n        this.donors = donors;\n        this.initMap(donors);\n        this.notificationService.notify('success', donors.length + ' donors loaded successfully');\n      }, error => console.log(error));\n    }\n\n    SearchAvailability(isAvailable) {\n      this.donorService.findByIsAvailable(isAvailable).subscribe(donors => {\n        this.donors = donors;\n        this.initMap(donors);\n        this.notificationService.notify('success', donors.length + ' donors loaded successfully');\n      }, error => console.log(error));\n    }\n\n    EmergencyRequest() {\n      console.log('EmergencyRequest**88');\n      this.donorService.sendEmergencyRequest().subscribe();\n      this.notificationService.notify('error', 'Emergency Declared');\n    }\n\n    initMap(donors) {\n      var markers = [];\n      const myLatLng = {\n        lat: 43.6532,\n        lng: -79.3832\n      };\n      const institute = {\n        lat: 43.65602,\n        lng: -79.7387\n      };\n      const institute1 = {\n        lat: 43.7473,\n        lng: -79.7435\n      };\n      const institute2 = {\n        lat: 43.6489,\n        lng: -79.8106\n      };\n      const institute3 = {\n        lat: 43.5562,\n        lng: -80.2533\n      };\n      const map = new google.maps.Map(document.getElementById('map'), {\n        zoom: 9,\n        center: myLatLng\n      });\n      donors.forEach(d => {\n        var marker = new google.maps.Marker({\n          position: {\n            lat: d['lat'],\n            lng: d['lng']\n          },\n          map,\n          label: d['bloodType'],\n          title: d['username'],\n          icon: this.person_icon\n        });\n        markers.push(marker);\n      });\n      new google.maps.Marker({\n        position: institute,\n        map,\n        title: 'institution#1!',\n        icon: this.hospital_icon\n      });\n      new google.maps.Marker({\n        position: institute1,\n        map,\n        title: 'William Osler Hospital',\n        icon: this.hospital_icon\n      });\n      new google.maps.Marker({\n        position: institute2,\n        map,\n        title: 'Toronto General Hospital',\n        icon: this.hospital_icon\n      });\n      new google.maps.Marker({\n        position: institute2,\n        map,\n        title: 'Toronto General Hospital',\n        icon: this.hospital_icon\n      });\n      new google.maps.Marker({\n        position: institute3,\n        map,\n        title: 'Guelph General Hospital',\n        icon: this.hospital_icon\n      });\n      markers.forEach(marker => {\n        marker.addListener(\"click\", () => {\n          this.SendRequest(marker.title);\n          console.log(marker.title);\n        });\n      });\n    }\n\n    SendRequest(username) {\n      this.donorService.SendRequest(username).subscribe();\n      console.log(username);\n      this.notificationService.notify('success', ' Email sent successfully!');\n    }\n\n  }\n\n  DonorListComponent.ɵfac = function DonorListComponent_Factory(t) {\n    return new (t || DonorListComponent)(i0.ɵɵdirectiveInject(i1.DonorService), i0.ɵɵdirectiveInject(i2.NotificationService));\n  };\n\n  DonorListComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: DonorListComponent,\n    selectors: [[\"app-donor-list\"]],\n    decls: 67,\n    vars: 7,\n    consts: [[\"src\", \"src/assets/divider.png\", 1, \"image-divider\"], [\"id\", \"mapWrapper\"], [\"id\", \"map\"], [\"id\", \"sec1\", 1, \"inlineDiv\"], [1, \"form-row\"], [\"placeholder\", \"Search by City\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"click\"], [\"id\", \"type\", 1, \"form-row\"], [\"name\", \"bloodType\", \"required\", \"\", 1, \"custom-select\", 3, \"ngModel\", \"keyup.enter\", \"ngModelChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"id\", \"avail\", 1, \"form-row\"], [3, \"ngModel\", \"ngModelChange\"], [3, \"value\"], [1, \"btn\", \"btn-primary\", 3, \"click\"], [\"id\", \"sec2\", 1, \"inlineDiv\"], [\"type\", \"reset\", 1, \"btn\", \"btn-info\", 3, \"click\"], [\"type\", \"submit\", 1, \"btn\", \"btn-info\"], [\"id\", \"sec3\", 1, \"inlineDiv\"], [1, \"btn\", \"btn-danger\", 3, \"click\"], [1, \"btn\", \"btn-danger\"], [1, \"table-responsive\"], [2, \"width\", \"-webkit-fill-available\"], [4, \"ngFor\", \"ngForOf\"], [1, \"badge\", \"bg-success\", 3, \"hidden\"], [1, \"badge\", \"bg-danger\", 3, \"hidden\"], [1, \"btn\", \"btn-info\", 3, \"click\"]],\n    template: function DonorListComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"img\", 0)(1, \"br\");\n        i0.ɵɵelementStart(2, \"div\", 1);\n        i0.ɵɵelement(3, \"div\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(4, \"br\")(5, \"br\")(6, \"img\", 0)(7, \"br\")(8, \"br\");\n        i0.ɵɵelementStart(9, \"div\", 3)(10, \"div\", 4)(11, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function DonorListComponent_Template_input_ngModelChange_11_listener($event) {\n          return ctx.city = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(12, \"\\u00A0 \");\n        i0.ɵɵelementStart(13, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function DonorListComponent_Template_button_click_13_listener() {\n          return ctx.SearchCity(ctx.city);\n        });\n        i0.ɵɵtext(14, \" Submit \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(15, \"div\", 7)(16, \"select\", 8);\n        i0.ɵɵlistener(\"keyup.enter\", function DonorListComponent_Template_select_keyup_enter_16_listener() {\n          return ctx.SearchBloodType(ctx.bloodType);\n        })(\"ngModelChange\", function DonorListComponent_Template_select_ngModelChange_16_listener($event) {\n          return ctx.bloodType = $event;\n        });\n        i0.ɵɵtemplate(17, DonorListComponent_option_17_Template, 2, 2, \"option\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(18, \"\\u00A0 \");\n        i0.ɵɵelementStart(19, \"button\", 6);\n        i0.ɵɵlistener(\"click\", function DonorListComponent_Template_button_click_19_listener() {\n          return ctx.SearchBloodType(ctx.bloodType);\n        });\n        i0.ɵɵtext(20, \" Submit \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(21, \"div\")(22, \"div\", 10)(23, \"select\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function DonorListComponent_Template_select_ngModelChange_23_listener($event) {\n          return ctx.isAvailable = $event;\n        });\n        i0.ɵɵelementStart(24, \"option\", 12);\n        i0.ɵɵtext(25, \"Available\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"option\", 12);\n        i0.ɵɵtext(27, \"Not Available\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtext(28, \"\\u00A0 \");\n        i0.ɵɵelementStart(29, \"button\", 13);\n        i0.ɵɵlistener(\"click\", function DonorListComponent_Template_button_click_29_listener() {\n          return ctx.SearchAvailability(ctx.isAvailable);\n        });\n        i0.ɵɵtext(30, \" Search Availability \");\n        i0.ɵɵelementEnd()()()();\n        i0.ɵɵelement(31, \"br\");\n        i0.ɵɵelementStart(32, \"div\", 14)(33, \"div\", 4)(34, \"button\", 15);\n        i0.ɵɵlistener(\"click\", function DonorListComponent_Template_button_click_34_listener() {\n          return ctx.ResetFilter();\n        });\n        i0.ɵɵtext(35, \" Reset Table \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(36, \"div\", 4)(37, \"button\", 16);\n        i0.ɵɵtext(38, \"Reset Filters\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(39, \"br\");\n        i0.ɵɵelementStart(40, \"div\", 17)(41, \"div\", 4)(42, \"button\", 18);\n        i0.ɵɵlistener(\"click\", function DonorListComponent_Template_button_click_42_listener() {\n          return ctx.EmergencyRequest();\n        });\n        i0.ɵɵtext(43, \" Send Emergency Request To All \");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(44, \"div\", 4)(45, \"button\", 19);\n        i0.ɵɵtext(46, \"Cancel Emergency Request To All\");\n        i0.ɵɵelementEnd()()();\n        i0.ɵɵelement(47, \"img\", 0)(48, \"br\");\n        i0.ɵɵelementStart(49, \"div\", 20)(50, \"table\", 21)(51, \"tr\")(52, \"th\");\n        i0.ɵɵtext(53, \"User ID\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(54, \"th\");\n        i0.ɵɵtext(55, \"Username\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(56, \"th\");\n        i0.ɵɵtext(57, \"Email\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(58, \"th\");\n        i0.ɵɵtext(59, \"City\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(60, \"th\");\n        i0.ɵɵtext(61, \"Blood Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(62, \"th\");\n        i0.ɵɵtext(63, \"Is available\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(64, \"th\");\n        i0.ɵɵtext(65, \"Send Request\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(66, DonorListComponent_ng_container_66_Template, 21, 7, \"ng-container\", 22);\n        i0.ɵɵelementEnd()();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngModel\", ctx.city);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.bloodType);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.bloodTypes);\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.isAvailable);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"value\", true);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"value\", false);\n        i0.ɵɵadvance(40);\n        i0.ɵɵproperty(\"ngForOf\", ctx.donors);\n      }\n    },\n    directives: [i3.DefaultValueAccessor, i3.NgControlStatus, i3.NgModel, i3.SelectControlValueAccessor, i3.RequiredValidator, i4.NgForOf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption],\n    styles: [\"#map[_ngcontent-%COMP%]{height:400px;width:100%;border:2px soild blue;border-radius:15px}#mapWrapper[_ngcontent-%COMP%]{padding:15px;border:3px solid rgb(121,18,125);border-radius:15px;background-color:#fff}button[_ngcontent-%COMP%]{margin-right:10px;margin-bottom:5px;background-color:#aa336a;color:#fff}.image-divider[_ngcontent-%COMP%]{margin:20px 0;width:100%}#sec1[_ngcontent-%COMP%]{position:relative;left:16%}input[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{height:35px}#sec2[_ngcontent-%COMP%]{position:relative;left:40%}#sec3[_ngcontent-%COMP%]{position:relative;left:27%}\"]\n  });\n  return DonorListComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}